---
title: "Annotation_PR2_Database"
author: "Johanna"
date: "2025-02-18"
output: html_document
---

```{bash}
conda activate 18S_
R
````

# Annotation of DADA2 Output to PR2 Database
Here, I am going to annotate the seqtab.nochim, created in 02_DADA2_18S_concatination.Rmd. Download the PR2 database (version 5.0.0. downloaded 22.05.2024) and store it, if possible on a cluster. 

Note: PR2 has different taxLevels than the DADA2 default. When assigning taxonomy against PR2,  Domain (replacing Kingdom), Supergroup, Division, Subdivision, Class, Order, Family, Genus, and Species, so use the following: assignTaxonomy(..., taxLevels = c("Domain","Supergroup","Division","Subdevision", "Class","Order","Family","Genus","Species"))

## Install Libraries 
```{r}
library(dada2)
```

## Assing taxonomy to PR2
Clarify, where you stored your PR2 Database and read the seqtab.nochim-table to your environment
```{r}
path_PR2 <- "/work_beegfs/ikmb_repository/databases/PR2/pr2_version_5.0.0_SSU_dada2.fasta" # Where is your PR2 database stored
seqtab.nochim <- readRDS("/home/sukmb626/seqtab.nochim_18S_all.rds") # where you stored your seqtab.nochim

#assign taxonomy to the seqtab.nochim generated in the session before and think about the different texLevels 
taxa <- assignTaxonomy(seqtab.nochim, path_PR2, multithread=TRUE, taxLevels = c("Domain","Supergroup","Division","Subdevision", "Class","Order","Family","Genus","Species"))

#check the fist lines of the taxa_table so that in the end can work with it! 
taxa.print <- taxa # Removing sequence rownames for display only
rownames(taxa.print) <- NULL
head(taxa.print)

##save the taxa table to continue with the generating of the Phyloseq Object
saveRDS(taxa, "/home/sukmb626/taxa_all.rds")
````
